



<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="author" content="Caelum"/>
	<meta name="reply-to" content="contato@caelum.com.br"/>
	<meta name="author" content="Design"/>
	<meta name="reply-to" content="lokidg@gmail.com"/>
	
		
		<link href="../../documentacao/includes/css/java.css" rel="stylesheet" type="text/css" media="screen" />
		<link href="../../documentacao/includes/css/xml2html.css" rel="stylesheet" type="text/css" media="screen" />
		<link href="../../documentacao/includes/css/style.css" rel="stylesheet" type="text/css" media="screen" />
	
	<meta name="description" content="VRaptor 3 - a Java web framework focused on fast development"/>
	<meta name="keywords" content="sites, web, desenvolvimento, development, java, opensource"/>
	<title>V|Raptor - High productivity in Java web development</title>
	<link href="../../screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../../menu.css" rel="stylesheet" type="text/css" media="screen" />
    <!--[if lt IE 7]>
    <script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js" type="text/javascript"></script>
    <![endif]-->
</head>

<body>
	<div id="headerWrap">
    	<div id="headerContent">
        	<h1 id="logoVraptor"><span>V|Raptor</span></h1><!-- vraptorlogo-->
            
            <ul id="langMenu">
            	<li><a id="engBtn" href="../../en/"><span>ENGLISH</span></a></li>
                <li><a id="ptBtn" href="../../pt/"><span>PORTUGUÊS</span></a></li>
            </ul><!-- langMenu-->            
        </div><!-- header content -->
    </div><!-- header wrap-->
    
    <div id="menuWrap">
    	<ul id="menuElementsEn">
        	<li><a id="homeBtnEn" href="../../en/"><span>home</span></a></li>
        	<li><a id="downloadBtnEn" href="../../en/download.jsp"><span>download</span></a></li>
        	<li><a id="documentacaoBtnEn" href="../../documentation/"><span>Documentation</span></a></li>
        	<li><a id="beneficiosBtnEn" href="../../benefits.jsp"><span>Benefits</span></a></li>
        	<li><a id="suporteBtnEn" href="../../support.jsp"><span>Support</span></a></li>
        	<li><a id="vraptor2BtnEn" href="../../en/vraptor2.jsp"><span>vraptor2</span></a></li>
        </ul><!-- menuElements-->
    </div><!-- menuWrap-->
<div id="contentWrap">
    	
			<ul id="subMenu">
				<li><a href="../../javadoc">Javadoc</a></li>
				<li>|</li>
				<li><a href="../../team.jsp">Team</a></li>
			</ul>
		<div id="contentDocumentacao">      	
			<div class="download"><a href="../vraptor3.pdf">Download as PDF</a></div>
        	<h2 class="title"><span>documentation</span></h2>
        	<h3 class="title">configuration, migration and utilization.</h3>            <div id="subMenuDoc">
            	<img id="positionTop" src="../includes/images/subMenuTop-trans.png" />
                <img id="positionBottom" src="../includes/images/subMenuBottom-trans.png" />
            	<ol type="1">
									<li><a class="link_toc" href="../../documentation/vraptor3-one-minute-guide/">1. VRaptor3 - One minute guide</a></li>
		
									<li><a class="link_toc" href="../../documentation/vraptor3-ten-minutes-guide/">2. VRaptor3 - Ten minutes guide</a></li>
		
									<li><a class="link_toc" href="../../documentation/resources-rest/">3. Resources-Rest</a></li>
		
									<li><a class="link_toc" href="../../documentation/components/">4. Components</a></li>
		
									<li><a class="link_toc" href="../../documentation/converters/">5. Converters</a></li>
		
									<li><a class="link_toc" href="../../documentation/interceptors/">6. Interceptors</a></li>
		
									<li><a class="link_toc" href="../../documentation/validation/">7. Validation</a></li>
		
									<li><a class="link_toc" href="../../documentation/view-and-ajax/">8. View and Ajax</a></li>
		
									<li><a class="link_toc" href="../../documentation/dependency-injection/">9. Dependency injection</a></li>
		
									<li><a class="link_toc" href="../../documentation/download-and-upload/">10. Download and Upload</a></li>
		
									<li><a class="link_toc" href="../../documentation/utility-components/">11. Utility Components</a></li>
		
									<li><a class="link_toc" href="../../documentation/advanced-configurations-overriding-vraptor-s-behavior-and-conventions/">12. Advanced configurations: overriding VRaptor's behavior and conventions</a></li>
		
									<li><a class="link_toc" href="../../documentation/google-app-engine/">13. Google App Engine</a></li>
		
									<li><a class="link_toc" href="../../documentation/testing-components-and-controllers/">14. Testing components and controllers</a></li>
		
									<li><a class="link_toc" href="../../documentation/scala/">15. Scala</a></li>
		
									<li><a class="link_toc" href="../../documentation/optimizations/">16. Optimizations</a></li>
		
									<li><a class="link_toc" href="../../documentation/vraptor-scaffold/">17. VRaptor Scaffold</a></li>
		
									<li><a class="link_toc" href="../../documentation/exception-handling/">18. Exception handling</a></li>
		
									<li><a class="link_toc" href="../../documentation/how-to-contribute-to-vraptor/">19. How to contribute to VRaptor</a></li>
		
									<li><a class="link_toc" href="../../documentation/changelog/">20. ChangeLog</a></li>
		
									<li><a class="link_toc" href="../../documentation/migrating-from-vraptor2-to-vraptor3/">21. Migrating from VRaptor2 to VRaptor3</a></li>
		
                </ol>
            </div><!-- submenu-->
                        
            <div id="textoCapitulo">
	
		<h2 class="chapter">View and Ajax</h2>

		


<h3 class="section">Sharing objects with the view</h3>
	    	<span class="paragraph">To register objects so they can be accessed in your templates:</span>
	    	<div class="java"><code class="java">
<span class="java16">@Resource<br />
</span><span class="java4">class </span><span class="java10">ClientController </span><span class="java8">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">private final </span><span class="java10">Result result;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java10">ClientController</span><span class="java8">(</span><span class="java10">Result result</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">this</span><span class="java10">.result = result;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java9">void </span><span class="java10">search</span><span class="java8">(</span><span class="java9">int </span><span class="java10">id</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java10">result.include</span><span class="java8">(</span><span class="java5">&#34;message&#34;</span><span class="java10">, </span><span class="java5">&#34;Some message&#34;</span><span class="java8">)</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result.include</span><span class="java8">(</span><span class="java5">&#34;client&#34;</span><span class="java10">, </span><span class="java4">new </span><span class="java10">Client</span><span class="java8">(</span><span class="java10">id</span><span class="java8">))</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
}</span></code></div>
	    	<span class="paragraph">The first object is accessed as "message", while the second as "client".
You can register objects by invoking include with only one parameter if you wish:</span>
	    	<div class="java"><code class="java">
<span class="java16">@Resource<br />
</span><span class="java4">class </span><span class="java10">ClientController </span><span class="java8">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">private final </span><span class="java10">Result result;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java10">ClientController</span><span class="java8">(</span><span class="java10">Result result</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">this</span><span class="java10">.result = result;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java9">void </span><span class="java10">search</span><span class="java8">(</span><span class="java9">int </span><span class="java10">id</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java10">result.include</span><span class="java8">(</span><span class="java5">&#34;Some message&#34;</span><span class="java8">)</span><span class="java10">.include</span><span class="java8">(</span><span class="java4">new </span><span class="java10">Client</span><span class="java8">(</span><span class="java10">id</span><span class="java8">))</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
}</span></code></div>
	    	<span class="paragraph">In this case, the first key is "string" while the second is "client".
Mix one argument and two arguments invocation to create simpler code for your application.
One can change the behaviour of the key extracting process by creating your own TypeNameExtractor.</span>
		

<h3 class="section">Custom PathResolver</h3>
	    	<span class="paragraph">By default, VRaptor tries to render your views following the convention:</span>
	    	<div class="java"><code class="java">
<span class="java4">public class </span><span class="java10">ClientsController </span><span class="java8">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java9">void </span><span class="java10">list</span><span class="java8">() {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java3">//...<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
}</span></code></div>
	    	<span class="paragraph">The method listed above will render the view <code class="inlineCode">/WEB-INF/jsp/clients/list.jsp</code>.</span>
	    	<span class="paragraph">However, we don't always want it to behave that way, specially if we need to use some
template engine like Freemarker or Velocity. In that case, we need to change the convention.</span>
	    	<span class="paragraph">An easy way of changing that convention is extending the <code class="inlineCode">DefaultPathResolver</code> class:</span>
	    	<div class="java"><code class="java">
<span class="java16">@Component<br />
</span><span class="java4">public class </span><span class="java10">FreemarkerPathResolver </span><span class="java4">extends </span><span class="java10">DefaultPathResolver </span><span class="java8">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">protected </span><span class="java10">String getPrefix</span><span class="java8">() {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">return </span><span class="java5">&#34;/WEB-INF/freemarker/&#34;</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">protected </span><span class="java10">String getExtension</span><span class="java8">() {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">return </span><span class="java5">&#34;ftl&#34;</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
}</span></code></div>
	    	<span class="paragraph">That way, the logic would try to render the view <code class="inlineCode">/WEB-INF/freemarker/clients/list.ftl</code>.
If that solution is not enough, you can implement the <code class="inlineCode">PathResolver</code> interface and do whatever convention you wish.
Don't forget to annotate your new classe with <code class="inlineCode">@Component</code>.</span>
		

<h3 class="section">View</h3>
	    	<span class="paragraph">If you want to change a specific logic's view, you can use the <code class="inlineCode">Result</code> object:</span>
	    	<div class="java"><code class="java">
<span class="java16">@Resource<br />
</span><span class="java4">public class </span><span class="java10">ClientsController </span><span class="java8">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">private final </span><span class="java10">Result result;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java10">ClientsController</span><span class="java8">(</span><span class="java10">Result result</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">this</span><span class="java10">.result = result;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java9">void </span><span class="java10">list</span><span class="java8">() {}<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java9">void </span><span class="java10">save</span><span class="java8">(</span><span class="java10">Client client</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java3">//...<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">this</span><span class="java10">.result.use</span><span class="java8">(</span><span class="java10">Results.logic</span><span class="java8">())</span><span class="java10">.redirectTo</span><span class="java8">(</span><span class="java10">ClientsController.</span><span class="java4">class</span><span class="java8">)</span><span class="java10">.list</span><span class="java8">()</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
}</span></code></div>
	    	<span class="paragraph">By default, there are these view implementations:</span>
	    	<ul class="list"><li><span class="paragraph">Results.logic(), redirects to any other logic in the application.</span></li><li><span class="paragraph">Results.page(), redirects directly to a page, that can be a jsp, an html, or any
	URI relative to the web application directory or the application context.</span></li><li><span class="paragraph">Results.http(), sends HTTP protocol informations, like status codes and headers.</span></li><li><span class="paragraph">Results.status(), sends status codes with more information.</span></li><li><span class="paragraph">Results.referer(), uses Referer header to redirect or forward.</span></li><li><span class="paragraph">Results.nothing(), simply returns the HTTP success code (HTTP 200 OK).</span></li><li><span class="paragraph">Results.xml(), uses xml serialization.</span></li><li><span class="paragraph">Results.json(), uses json serialization.</span></li><li><span class="paragraph">Results.representation(), serializes objects in a format set by the request
	 (_format parameter or Accept header)</span></li></ul>
		

<h3 class="section">Result shortcuts</h3>
	    	<span class="paragraph">Some redirections are pretty common, so there are shortcuts on Result interface for them.
The available shortcuts are:</span>
	    	<ul class="list"><li><span class="paragraph">result.forwardTo("/some/uri") 			==&gt; result.use(page()).forward("/some/uri");</span></li><li><span class="paragraph">result.redirectTo("/some/uri") 			==&gt;  result.use(page()).redirect("/some/uri)</span></li><li><span class="paragraph">result.permanentlyRedirectTo("/some/uri") ==&gt; result.use(status()).movedPermanentlyTo("/some/uri");</span></li><li><span class="paragraph">result.forwardTo(ClientController.class).list() ==&gt; result.use(logic()).forwardTo(ClientController.class).list();</span></li><li><span class="paragraph">result.redirectTo(ClientController.class).list() ==&gt; result.use(logic()).redirectTo(ClientController.class).list();</span></li><li><span class="paragraph">result.of(ClientController.class).list() 	==&gt; result.use(page()).of(ClientController.class).list();</span></li><li><span class="paragraph">result.permanentlyRedirectTo(Controller.class) ==&gt; use(status()).movedPermanentlyTo(Controller.class);</span></li><li><span class="paragraph">result.notFound()							==&gt;  use(status()).notFound()</span></li><li><span class="paragraph">result.nothing()							==&gt;  use(nothing());</span></li></ul>
	    	<span class="paragraph">Furthermore, if one are redirecting to a method on the same controller, one can use:</span>
	    	<ul class="list"><li><span class="paragraph">result.forwardTo(this).list() 		==&gt; result.use(logic()).forwardTo(this.getClass()).list();</span></li><li><span class="paragraph">result.redirectTo(this).list() 		==&gt; result.use(logic()).redirectTo(this.getClass()).list();</span></li><li><span class="paragraph">result.of(this).list() 				==&gt; result.use(page()).of(this.getClass()).list();</span></li><li><span class="paragraph">result.permanentlyRedirectTo(this) 	==&gt; use(status()).movedPermanentlyTo(this.getClass());</span></li></ul>
		

<h3 class="section">Redirect and forward</h3>
	    	<span class="paragraph">In VRaptor3, you can either redirect or forward the user to another logic or page.
The main difference between redirecting and forwarding is that the former happens
at client side, while the latter happens at server side.</span>
	    	<span class="paragraph">A good redirect use is the pattern 'redirect-after-post', for example, when you add
a client and you want to return to the client listing page, but you want to avoid
the user to accidentally resend all data by refreshing (F5) the page.</span>
	    	<span class="paragraph">An example of forwarding is when you have some data validation that fails, usually you
want the user to remain on the form with all the previously filled data.</span>
	    	<div class="box"><h3>Automatic Flash Scope</h3>
<span class="paragraph">If you add objects on Result and redirects to another logic, these objects will be available
on the next request.</span><div class="java"><code class="java">
<span class="java4">public </span><span class="java9">void </span><span class="java10">add</span><span class="java8">(</span><span class="java10">Client client</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="java10">dao.add</span><span class="java8">(</span><span class="java10">client</span><span class="java8">)</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp; result.include</span><span class="java8">(</span><span class="java5">&#34;notice&#34;</span><span class="java10">, </span><span class="java5">&#34;Client successfully added&#34;</span><span class="java8">)</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp; result.redirectTo</span><span class="java8">(</span><span class="java10">ClientsController.</span><span class="java4">class</span><span class="java8">)</span><span class="java10">.list</span><span class="java8">()</span><span class="java10">;<br />
</span><span class="java8">}</span></code></div><span class="paragraph">list.jsp:</span><div class="xml"><code class="xml">...<br />
<span class="textag">&lt;div</span>&nbsp;<span class="texattrib">id=</span><span class="texvalue">"notice"</span><span class="textag">&gt;</span><span class="texnormal"><br /></span>
<span class="texnormal">&nbsp;&nbsp;&nbsp;</span><span class="textag">&lt;h3&gt;</span><span class="texnormal">${notice}</span><span class="textag">&lt;/h3&gt;</span><span class="texnormal"><br /></span>
<span class="texnormal"></span><span class="textag">&lt;/div&gt;</span><br />
...</code></div></div>
		

<h3 class="section">Accepts and the _format parameter</h3>
	    	<span class="paragraph">Many times you need to render different formats for the same logic. For example,
we want to return a JSON object instead of an HTML page.
In order to do that, we can define the request's Accepts header to accept the desired
format, or we can pass a <code class="inlineCode">_format</code> paramenter in the request.</span>
	    	<span class="paragraph">If the specified format is JSON, the default rendered view will be: <code class="inlineCode">/WEB-INF/jsp/{controller}/{logic}.json.jsp</code>,
which means, in general, the rendered view will be: <code class="inlineCode">/WEB-INF/jsp/{controller}/{logic}.{format}.jsp</code>.
If the format is HTML, then you won't need to specify it in the file name.</span>
	    	<span class="paragraph">The <code class="inlineCode">_format</code> parameter has a higher priority over the Accepts header.</span>
		

<h3 class="section">Ajax: building on the view</h3>
	    	<span class="paragraph">In order to return a JSON object to the view, your logic must make that object available somehow.
Just like the following example, your <code class="inlineCode">/WEB-INF/jsp/clients/load.json.jsp</code>:</span>
	    	<div class="java"><code class="java">{&nbsp;name:&nbsp;'${client.name}',&nbsp;id:&nbsp;'${client.id}'&nbsp;}</code></div>
	    	<span class="paragraph">And in the controller:</span>
	    	<div class="java"><code class="java">
<span class="java16">@Resource<br />
</span><span class="java4">public class </span><span class="java10">ClientsController </span><span class="java8">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">private final </span><span class="java10">Result result;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">private final </span><span class="java10">ClientDao dao;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java10">ClientsController</span><span class="java8">(</span><span class="java10">Result result, ClientDao dao</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">this</span><span class="java10">.result = result;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">this</span><span class="java10">.dao = dao;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java9">void </span><span class="java10">load</span><span class="java8">(</span><span class="java10">Client client</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java10">result.include</span><span class="java8">(</span><span class="java5">&#34;client&#34;</span><span class="java10">, dao.load</span><span class="java8">(</span><span class="java10">client</span><span class="java8">))</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
}</span></code></div>
		

<h3 class="section">Ajax: Programatic version</h3>
	    	<span class="paragraph">If you want that VRaptor automatically serializes your objects into xml or json, you can use
on your logic:</span>
	    	<div class="java"><code class="java">
<span class="java4">import static </span><span class="java10">br.com.caelum.vraptor.view.Results.*;<br />
</span><span class="java16">@Resource<br />
</span><span class="java4">public class </span><span class="java10">ClientsController </span><span class="java8">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">private final </span><span class="java10">Result result;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">private final </span><span class="java10">ClientDao dao;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java10">ClientsController</span><span class="java8">(</span><span class="java10">Result result, ClientDao dao</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">this</span><span class="java10">.result = result;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">this</span><span class="java10">.dao = dao;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java9">void </span><span class="java10">loadJson</span><span class="java8">(</span><span class="java10">Client client</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java10">result.use</span><span class="java8">(</span><span class="java10">json</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">client</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">public </span><span class="java9">void </span><span class="java10">loadXml</span><span class="java8">(</span><span class="java10">Client client</span><span class="java8">) {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java10">result.use</span><span class="java8">(</span><span class="java10">xml</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">client</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
}</span></code></div>
	    	<span class="paragraph">The results will be like:</span>
	    	<div class="java"><code class="java">{"client":&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;"name":&nbsp;"John"<br />
}}</code></div>
	    	<div class="java"><code class="java">&lt;client&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;John&lt;/name&gt;<br />
&lt;/client&gt;</code></div>
	    	<span class="paragraph">By default, only fields with primitive types will be serialized (String, numbers, enums, dates),
if you want to include a field of a non-primitive type you must explicitly include it:</span>
	    	<div class="java"><code class="java">
<span class="java10">result.use</span><span class="java8">(</span><span class="java10">json</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">client</span><span class="java8">)</span><span class="java10">.include</span><span class="java8">(</span><span class="java5">&#34;address&#34;</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;</span></code></div>
	    	<span class="paragraph">will result in something like:</span>
	    	<div class="java"><code class="java">{"client":&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;"name":&nbsp;"John",<br />
&nbsp;&nbsp;&nbsp;&nbsp;"address"&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"street":&nbsp;"First&nbsp;Avenue"<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
}}</code></div>
	    	<span class="paragraph">You can also exclude primitive fields from serialization:</span>
	    	<div class="java"><code class="java">
<span class="java10">result.use</span><span class="java8">(</span><span class="java10">json</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">user</span><span class="java8">)</span><span class="java10">.exclude</span><span class="java8">(</span><span class="java5">&#34;password&#34;</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;</span></code></div>
	    	<span class="paragraph">will result in something like:</span>
	    	<div class="java"><code class="java">{"user":&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;"name":&nbsp;"John",<br />
&nbsp;&nbsp;&nbsp;&nbsp;"login":&nbsp;"john"<br />
}}</code></div>
	    	<span class="paragraph">Moreover you can serialize recursively (be careful with cycles):</span>
	    	<div class="java"><code class="java">
<span class="java10">result.use</span><span class="java8">(</span><span class="java10">json</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">user</span><span class="java8">)</span><span class="java10">.recursive</span><span class="java8">()</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;<br />
result.use</span><span class="java8">(</span><span class="java10">xml</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">user</span><span class="java8">)</span><span class="java10">.recursive</span><span class="java8">()</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;</span></code></div>
	    	<span class="paragraph">The default implementation is based on XStream, so you can configure the serialization
with annotations and direct configuration on XStream. It is just creating a class like:</span>
	    	<div class="java"><code class="java">
<span class="java16">@Component<br />
</span><span class="java4">public class </span><span class="java10">CustomXMLSerialization </span><span class="java4">extends </span><span class="java10">XStreamXMLSerialization </span><span class="java8">{<br />
</span><span class="java3">//or public class CustomJSONSerialization extends XStreamJSONSerialization {<br />
&nbsp;&nbsp;&nbsp; //delegate constructor<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="java16">@Override<br />
&nbsp;&nbsp;&nbsp; </span><span class="java4">protected </span><span class="java10">XStream getXStream</span><span class="java8">() {<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java10">XStream xStream = </span><span class="java4">super</span><span class="java10">.getXStream</span><span class="java8">()</span><span class="java10">;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java3">//your xStream setup here<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="java4">return </span><span class="java10">xStream;<br />
&nbsp;&nbsp;&nbsp; </span><span class="java8">}<br />
}</span></code></div>
	    	<span class="paragraph"><strong class="title">Serializing Collections</strong></span>
	    	<span class="paragraph">When serializing collections, vRaptor will wrap their elements with a "list" tag:</span>
	    	<div class="java"><code class="java">
<span class="java10">List&lt;Client&gt; clients = ...;<br />
result.use</span><span class="java8">(</span><span class="java10">json</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">clients</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;<br />
</span><span class="java3">//or<br />
</span><span class="java10">result.use</span><span class="java8">(</span><span class="java10">xml</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">clients</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;</span></code></div>
	    	<span class="paragraph">will result in something like</span>
	    	<div class="java"><code class="java">{"list":&nbsp;[<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"name":&nbsp;"John"<br />
&nbsp;&nbsp;&nbsp;&nbsp;},<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"name":&nbsp;"Sue"<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
]}</code></div>
	    	<span class="paragraph">or</span>
	    	<div class="java"><code class="java">&lt;list&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;client&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;John&lt;/name&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/client&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;client&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;Sue&lt;/name&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/client&gt;<br />
&lt;/list&gt;</code></div>
	    	<span class="paragraph">You can customize the wrapper element via:</span>
	    	<div class="java"><code class="java">
<span class="java10">List&lt;Client&gt; clients = ...;<br />
result.use</span><span class="java8">(</span><span class="java10">json</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">clients, </span><span class="java5">&#34;clients&#34;</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;<br />
</span><span class="java3">//or<br />
</span><span class="java10">result.use</span><span class="java8">(</span><span class="java10">xml</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">clients, </span><span class="java5">&#34;clients&#34;</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;</span></code></div>
	    	<span class="paragraph">will result in something like:</span>
	    	<div class="java"><code class="java">{"clients":&nbsp;[<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"name":&nbsp;"John"<br />
&nbsp;&nbsp;&nbsp;&nbsp;},<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"name":&nbsp;"Sue"<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
]}</code></div>
	    	<span class="paragraph">or</span>
	    	<div class="java"><code class="java">&lt;clients&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;client&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;John&lt;/name&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/client&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;client&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;Sue&lt;/name&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/client&gt;<br />
&lt;/clients&gt;</code></div>
	    	<span class="paragraph">Includes and excludes work the same as if you were serializing an element inside the collection.
For instance, if you want to include the client's address:</span>
	    	<div class="java"><code class="java">
<span class="java10">List&lt;Cliente&gt; clients = ...;<br />
result.use</span><span class="java8">(</span><span class="java10">json</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">clients</span><span class="java8">)</span><span class="java10">.include</span><span class="java8">(</span><span class="java5">&#34;address&#34;</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">;</span></code></div>
	    	<span class="paragraph">results in:</span>
	    	<div class="java"><code class="java">{"list":&nbsp;[<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"name":&nbsp;"John",<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"address":&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"street":&nbsp;"Vergueiro,&nbsp;3185"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;},<br />
&nbsp;&nbsp;&nbsp;&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"name":&nbsp;"Sue",<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"address":&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"street":&nbsp;"Vergueiro,&nbsp;3185"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
]}</code></div>
	    	<span class="paragraph"><strong class="title">Serializing JSON without root element</strong>
If you want to serialize an object to json without give it any names, you can use the
withoutRoot method:</span>
	    	<div class="java"><code class="java">
<span class="java10">result.use</span><span class="java8">(</span><span class="java10">json</span><span class="java8">())</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">car</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">; </span><span class="java3">//=&gt; {'car': {'color': 'blue'}}<br />
</span><span class="java10">result.use</span><span class="java8">(</span><span class="java10">json</span><span class="java8">())</span><span class="java10">.withoutRoot</span><span class="java8">()</span><span class="java10">.from</span><span class="java8">(</span><span class="java10">car</span><span class="java8">)</span><span class="java10">.serialize</span><span class="java8">()</span><span class="java10">; </span><span class="java3">//=&gt; {'color': 'blue'}</span></code></div>
		

</div><!-- content -->
            
        </div><!-- content cnt -->
    </div><!-- content wrap-->
    




		

    <div id="footerWrap">
    	<div id="footerContent">              
            <div id="suporteFooter">
	           	<a href="http://www.caelum.com.br/contato/" class="moreIcon" title="Saiba Mais"><span>+</span></a>
	           	<h3><a href="http://www.caelum.com.br/contato/">Support</a></h3>
                <p><a href="http://www.caelum.com.br/contato/">Get to know about our online support plans and be certain that your doubts and problems will be quickly solved.</a></p>            
            </div><!-- suporte-->
            <div id="consultoriaFooter">
           		<a href="http://www.caelum.com.br/servicos/consultoria/" class="moreIcon" title="Saiba Mais"><span>+</span></a>
           		<h3><a href="http://www.caelum.com.br/servicos/consultoria/">Consulting</a></h3>
                <p><a href="http://www.caelum.com.br/servicos/consultoria/">The VRaptor development team is available to help your development team. Learn about our consulting plans.</a></p>            
            </div><!-- consultoria-->
        	<div id="treinamentoFooter">
            	<a href="http://www.caelum.com.br/curso/fj-28-vraptor-hibernate-ajax/" class="moreIcon" title="Saiba Mais"><span>+</span></a><h3><a href="http://www.caelum.com.br/curso/fj-28-vraptor-hibernate-ajax/">Training</a></h3>
                <p><a href="http://www.caelum.com.br/curso/fj-28-vraptor-hibernate-ajax/">Caelum offers the oficial VRaptor training, with Hibernate and Ajax, focusing on the best practices concerning VRaptor. Click and find out more about it.</a></p>
            </div><!--treinamento-->
     <div class="footbar">
            	<img class="logoFooter" src="../../images/logoCaelumGray-trans.png" alt="vraptor logo" />
                <ul>
                	<li>site map:</li>
                    <li><a href="../../en/">home</a></li>
                    <li>|</li>
                    <li><a href="../../en/download.jsp">download</a></li>
                    <li>|</li>
                    <li><a href="../../documentation/">Documentation</a></li>
                    <li>|</li>
                    <li><a href="../../benefits.jsp">Benefits</a></li>
                    <li>|</li>
                    <li><a href="../../support.jsp">Support</a></li>
                    <li>|</li>
                    <li><a href="../../en/vraptor2.jsp">vraptor2</a></li>
                </ul>
                <p><a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a> - VRaptor ©2009 Caelum - Ensino e Inovação</p>
                <p>Profiled with <a href="http://www.ej-technologies.com/products/jprofiler/overview.html">JProfiler</a></p>
            </div><!-- footnote-->
        </div><!-- footer content -->
        <a id="signature" href="mailto:lokidg@gmail.com">loki|design</a>
    </div><!-- footer wrap-->
<script type="text/javascript">
	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
	document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>

<script type="text/javascript">
	try {
	var pageTracker = _gat._getTracker("UA-270161-11");
	pageTracker._trackPageview();
	} catch(err) {}
 </script>
    
</body>
</html>
